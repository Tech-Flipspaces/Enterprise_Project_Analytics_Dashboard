{% extends "core/base.html" %}

{% block content %}
<div class="container-fluid py-4">
    
    <div class="d-flex justify-content-between align-items-center mb-4">
        <div>
            <h2 class="fw-bold text-primary">{{ report_title|default:"Detailed Project Report" }}</h2>
            <p class="text-muted mb-0">
                <i class="fas fa-layer-group me-1"></i> Department: <strong>{{ view_mode }}</strong> | 
                <i class="far fa-calendar-alt ms-2 me-1"></i> Range: {{ start_date }} to {{ end_date }}
            </p>
        </div>
        <div>
            <button onclick="window.print()" class="btn btn-outline-secondary">
                <i class="fas fa-print me-1"></i> Print / Save PDF
            </button>
            <a href="{% url 'dashboard' %}?view={{ view_mode }}&start={{ start_date }}&end={{ end_date }}" class="btn btn-primary ms-2">
                <i class="fas fa-arrow-left me-1"></i> Back to Dashboard
            </a>
        </div>
    </div>

    {% if df_pre %}
    <div class="card shadow-sm mb-4">
        <div class="card-header bg-light py-3">
            <h5 class="mb-0 text-secondary">
                {% if view_mode == 'Sales' %}Pre-Sales Stage{% else %}Pre-Stage / Login{% endif %}
            </h5>
        </div>
        <div class="card-body p-0">
            <div class="table-responsive">
                {{ df_pre|safe }}
            </div>
        </div>
    </div>
    {% endif %}

    {% if df_post %}
    <div class="card shadow-sm">
        <div class="card-header bg-light py-3">
            <h5 class="mb-0 text-secondary">
                {% if view_mode == 'Sales' %}Post-Sales Stage{% else %}Post-Stage / Execution{% endif %}
            </h5>
        </div>
        <div class="card-body p-0">
            <div class="table-responsive">
                {{ df_post|safe }}
            </div>
        </div>
    </div>
    {% endif %}

    {% if not df_pre and not df_post %}
    <div class="alert alert-warning text-center p-5">
        <h4><i class="fas fa-exclamation-circle me-2"></i>No Data Found</h4>
        <p class="mb-0">No projects matched your criteria ({{ view_mode }} | {{ start_date }} to {{ end_date }}).</p>
    </div>
    {% endif %}

</div>

<style>
    /* Force Pandas tables to fit Bootstrap styling */
    table.dataframe {
        width: 100%;
        border-collapse: collapse;
        margin-bottom: 0;
    }
    table.dataframe th {
        background-color: #f8f9fa;
        color: #495057;
        font-weight: 600;
        text-align: center;
        padding: 12px;
        border-bottom: 2px solid #dee2e6;
    }
    table.dataframe td {
        padding: 10px;
        border-bottom: 1px solid #dee2e6;
        vertical-align: middle;
        text-align: center; /* Center align data for better readability */
    }
    table.dataframe tr:nth-child(even) {
        background-color: #f8f9fa; /* Striped effect */
    }
    table.dataframe tr:hover {
        background-color: #e9ecef; /* Hover effect */
    }
    
    /* Specific tweaks for Leadership Summary Table */
    /* If the table has fewer columns (Summary view), constrain width for readability */
    table.dataframe th:first-child, table.dataframe td:first-child {
        text-align: left; /* Align Metric Names to left */
        padding-left: 20px;
    }
</style>
{% endblock %}